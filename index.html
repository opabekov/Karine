<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Valentine</title>
  <style>
    :root{
      --bg1:#fff6fb;
      --bg2:#f3f6ff;
      --card:#ffffffd8;
      --text:#2b2b2b;
      --accent:#ff4f8a;
      --border:#00000010;
    }
    *{ box-sizing:border-box; }

    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 500px at 20% 15%, #ffe8f5 0%, transparent 60%),
        radial-gradient(800px 520px at 85% 25%, #e9f0ff 0%, transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow:hidden;
    }

    .hearts{ position:fixed; inset:0; pointer-events:none; opacity:.55; }
    .heart{
      position:absolute;
      width:16px; height:16px;
      transform: rotate(45deg);
      background: color-mix(in srgb, var(--accent) 80%, white);
      border-radius:3px;
      filter: drop-shadow(0 10px 14px rgba(255,79,138,.35));
      animation: floatUp linear infinite;
    }
    .heart::before,.heart::after{
      content:"";
      position:absolute;
      width:16px; height:16px;
      background:inherit;
      border-radius:50%;
    }
    .heart::before{ left:-8px; top:0; }
    .heart::after{ left:0; top:-8px; }
    @keyframes floatUp{
      from{ transform: translateY(30vh) rotate(45deg); opacity:0; }
      10%{ opacity:.55; }
      to{ transform: translateY(-120vh) rotate(45deg); opacity:0; }
    }

    .card{
      width:min(760px, 92vw);
      background:var(--card);
      backdrop-filter: blur(12px);
      border:1px solid #ffffffb3;
      border-radius:30px;
      padding:36px 28px 28px;
      box-shadow: 0 18px 60px rgba(0,0,0,.10);
      text-align:center;
    }

    /* HEAD BIGGER (responsive) */
    .head-img{
      display:block;
      margin: 0 auto 18px;
      width: clamp(220px, 34vw, 340px);
      aspect-ratio: 1 / 1;
      height: auto;
      object-fit: contain;
      filter: drop-shadow(0 14px 22px rgba(0,0,0,.12));
    }

    h1{
      margin:0;
      font-size: clamp(26px, 4.2vw, 42px);
      line-height:1.15;
      letter-spacing:-0.02em;
    }

    /* Absolute layout so YES never shifts */
    .buttons{
      margin-top:26px;
      position:relative;
      height:90px;
    }

    button{
      border:1px solid var(--border);
      background:white;
      color:var(--text);
      padding:14px 26px;
      border-radius:18px;
      font-size:18px;
      cursor:pointer;
      box-shadow: 0 10px 20px rgba(0,0,0,.06);
      transition: transform .12s ease, box-shadow .12s ease;
      user-select:none;
      touch-action: manipulation;
      min-width: 120px;
      position:absolute; /* IMPORTANT: no layout shifting */
      top:50%;
      left:50%;
    }
    button:hover{
      box-shadow: 0 14px 26px rgba(0,0,0,.08);
    }

    /* YES = left, fixed */
    #yesBtn{
      background: linear-gradient(135deg, color-mix(in srgb, var(--accent) 78%, white), #ffd3e3);
      border-color:#ffffff90;
      transform: translate(calc(-50% - 90px), -50%); /* left of center */
      z-index:2;
    }
    /* lock YES from moving on hover */
    #yesBtn:hover{
      transform: translate(calc(-50% - 90px), -50%);
      box-shadow: 0 14px 26px rgba(0,0,0,.08);
    }

    /* NO = right initially, then JS moves it */
    #noBtn{
      transform: translate(calc(-50% + 90px), -50%); /* right of center */
      z-index:1;
    }
  </style>
</head>
<body>
  <div class="hearts" id="hearts"></div>

  <main class="card">
    <img class="head-img" src="./head.png" alt="head">
    <h1 id="title">Karine, will you be my Valentine? üíó</h1>

    <div class="buttons" id="btnArea">
      <button id="yesBtn">Yes</button>
      <button id="noBtn">No</button>
    </div>
  </main>

<script>
  const params = new URLSearchParams(location.search);
  const name = params.get("name") || "Karine";
  const msg  = params.get("msg")  || "will you be my Valentine? üíó";
  document.getElementById("title").textContent = `${name}, ${msg}`;

  const yesBtn = document.getElementById("yesBtn");
  const noBtn  = document.getElementById("noBtn");

  yesBtn.addEventListener("click", () => {
    window.location.href = "./yes.html" + (location.search || "");
  });

  // --- –í–ê–ñ–ù–û: –≤—ã–Ω–æ—Å–∏–º No –∏–∑ –∫–∞—Ä—Ç–æ—á–∫–∏, —á—Ç–æ–±—ã –æ–Ω–∞ –∫–∞—Ç–∞–ª–∞—Å—å –ø–æ –≤—Å–µ–º—É —ç–∫—Ä–∞–Ω—É
  document.body.appendChild(noBtn);

  // –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–ª–æ–∫–∏—Ä—É–µ–º –∫–ª–∏–∫–∏ –ø–æ No
  ["pointerdown", "click", "mousedown", "touchstart"].forEach(evt => {
    noBtn.addEventListener(evt, (e) => {
      e.preventDefault();
      e.stopPropagation();
    }, { passive: false });
  });

  // ---------- –ü–ª–∞–≤–Ω–æ–µ —É–±–µ–≥–∞–Ω–∏–µ (—Ñ–∏–∑–∏–∫–∞) ----------
  let noW = 0, noH = 0;
  function measureNo(){
    noW = noBtn.offsetWidth;
    noH = noBtn.offsetHeight;
  }
  measureNo();

  // –ø–æ–∑–∏—Ü–∏—è No (–≤–µ—Ä—Ö-–ª–µ–≤—ã–π —É–≥–æ–ª) –∏ —Å–∫–æ—Ä–æ—Å—Ç—å
  let x = 0, y = 0, vx = 0, vy = 0;

  // –∫—É—Ä—Å–æ—Ä
  let cursorX = window.innerWidth / 2;
  let cursorY = window.innerHeight / 2;

  window.addEventListener("pointermove", (e) => {
    cursorX = e.clientX;
    cursorY = e.clientY;
  });

  function clamp(v, min, max){ return Math.max(min, Math.min(max, v)); }

  // —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è: —Å–ø—Ä–∞–≤–∞ –æ—Ç YES
  function placeInitial(){
    const r = yesBtn.getBoundingClientRect();
    x = r.right + 30;
    y = r.top + (r.height / 2) - (noH / 2);
    // –º–æ–∂–Ω–æ —á—É—Ç—å ‚Äú–∑–∞ –∫—Ä–∞—è –æ–∫–Ω–∞‚Äù ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º –Ω–µ–±–æ–ª—å—à–æ–π –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π margin
    const out = Math.min(40, noW * 0.35);
    const minX = -out;
    const minY = -out;
    const maxX = window.innerWidth  - noW + out;
    const maxY = window.innerHeight - noH + out;
    x = clamp(x, minX, maxX);
    y = clamp(y, minY, maxY);
  }
  placeInitial();

  // –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–≤–µ–¥–µ–Ω–∏—è
  const CURSOR_RADIUS   = 190;  // –∫–∞–∫ –±–ª–∏–∑–∫–æ –∫—É—Ä—Å–æ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å
  const CURSOR_FORCE    = 1.25; // —Å–∏–ª–∞ –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏—è –æ—Ç –∫—É—Ä—Å–æ—Ä–∞
  const YES_PAD         = 50;   // ‚Äú–∑–∞–ø—Ä–µ—Ç–Ω–∞—è –∑–æ–Ω–∞‚Äù –≤–æ–∫—Ä—É–≥ YES
  const YES_FORCE       = 1.60; // —Å–∏–ª–∞ –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏—è –æ—Ç YES –∑–æ–Ω—ã
  const FRICTION        = 0.88; // —Ç—Ä–µ–Ω–∏–µ (–ø–ª–∞–≤–Ω–æ—Å—Ç—å)
  const MAX_SPEED       = 22;   // –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
  const OUTSIDE_MARGIN  = 40;   // –Ω–∞—Å–∫–æ–ª—å–∫–æ –º–æ–∂–Ω–æ –≤—ã–ª–µ–∑–∞—Ç—å –∑–∞ –∫—Ä–∞–π —ç–∫—Ä–∞–Ω–∞

  function repelFromPoint(cx, cy, px, py, radius, force){
    const dx = cx - px;
    const dy = cy - py;
    const dist = Math.hypot(dx, dy) || 1;

    if (dist >= radius) return;

    // —á–µ–º –±–ª–∏–∂–µ ‚Äî —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ (–∫–≤–∞–¥—Ä–∞—Ç)
    const k = 1 - (dist / radius);
    const f = (k * k) * force;

    vx += (dx / dist) * f;
    vy += (dy / dist) * f;
  }

  function repelFromRect(cx, cy, rect, pad, force){
    const left   = rect.left   - pad;
    const right  = rect.right  + pad;
    const top    = rect.top    - pad;
    const bottom = rect.bottom + pad;

    const nx = clamp(cx, left, right);
    const ny = clamp(cy, top, bottom);

    const dx = cx - nx;
    const dy = cy - ny;
    const dist = Math.hypot(dx, dy) || 1;

    // –µ—Å–ª–∏ –≤–Ω—É—Ç—Ä–∏ –∑–∞–ø—Ä–µ—Ç–Ω–æ–π –∑–æ–Ω—ã ‚Äî —Å–∏–ª—å–Ω–æ –≤—ã—Ç–∞–ª–∫–∏–≤–∞–µ–º
    if (cx >= left && cx <= right && cy >= top && cy <= bottom) {
      const f = force * 2.2;
      vx += (dx / dist) * f;
      vy += (dy / dist) * f;
      return;
    }

    // –µ—Å–ª–∏ —Ä—è–¥–æ–º ‚Äî –º—è–≥–∫–æ –≤—ã—Ç–∞–ª–∫–∏–≤–∞–µ–º
    const nearRadius = 120;
    if (dist < nearRadius) {
      const k = 1 - dist / nearRadius;
      const f = (k * k) * force;
      vx += (dx / dist) * f;
      vy += (dy / dist) * f;
    }
  }

  function bounds(){
    const out = OUTSIDE_MARGIN; // –¥–∞—ë–º –≤—ã–ª–µ–∑–∞—Ç—å
    const minX = -out;
    const minY = -out;
    const maxX = window.innerWidth  - noW + out;
    const maxY = window.innerHeight - noH + out;
    return { minX, minY, maxX, maxY };
  }

  function tick(){
    // —Ü–µ–Ω—Ç—Ä –∫–Ω–æ–ø–∫–∏
    const cx = x + noW / 2;
    const cy = y + noH / 2;

    // 1) –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏–µ –æ—Ç –∫—É—Ä—Å–æ—Ä–∞
    repelFromPoint(cx, cy, cursorX, cursorY, CURSOR_RADIUS, CURSOR_FORCE);

    // 2) –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏–µ –æ—Ç –∑–æ–Ω—ã YES (—á—Ç–æ–±—ã No –ù–ò–ö–û–ì–î–ê –Ω–µ –∑–∞–µ–∑–∂–∞–ª–∞ –Ω–∞ Yes)
    const yesRect = yesBtn.getBoundingClientRect();
    repelFromRect(cx, cy, yesRect, YES_PAD, YES_FORCE);

    // 3) –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ + —Ç—Ä–µ–Ω–∏–µ
    vx *= FRICTION;
    vy *= FRICTION;

    // –ª–∏–º–∏—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏
    const sp = Math.hypot(vx, vy);
    if (sp > MAX_SPEED) {
      vx = (vx / sp) * MAX_SPEED;
      vy = (vy / sp) * MAX_SPEED;
    }

    x += vx;
    y += vy;

    // 4) –≥—Ä–∞–Ω–∏—Ü—ã (–º–æ–∂–µ—Ç –≤—ã–ª–µ–∑–∞—Ç—å —á—É—Ç—å –∑–∞ —ç–∫—Ä–∞–Ω)
    const { minX, minY, maxX, maxY } = bounds();

    // –º—è–≥–∫–∏–π ‚Äú–æ—Ç—Å–∫–æ–∫‚Äù, —á—Ç–æ–±—ã –Ω–µ —É–ª–µ—Ç–∞–ª–∞ –Ω–∞–≤—Å–µ–≥–¥–∞
    if (x < minX) { x = minX; vx *= -0.55; }
    if (y < minY) { y = minY; vy *= -0.55; }
    if (x > maxX) { x = maxX; vx *= -0.55; }
    if (y > maxY) { y = maxY; vy *= -0.55; }

    noBtn.style.transform = `translate3d(${x}px, ${y}px, 0)`;

    requestAnimationFrame(tick);
  }
  requestAnimationFrame(tick);

  // –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤/–≥—Ä–∞–Ω–∏—Ü
  window.addEventListener("resize", () => {
    measureNo();
  });
</script>
</body>
</html>
