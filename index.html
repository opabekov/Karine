<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Valentine</title>
  <style>
    :root{
      --bg1:#fff6fb;
      --bg2:#f3f6ff;
      --card:#ffffffd8;
      --text:#2b2b2b;
      --accent:#ff4f8a;
      --border:#00000010;
    }
    *{ box-sizing:border-box; }

    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 500px at 20% 15%, #ffe8f5 0%, transparent 60%),
        radial-gradient(800px 520px at 85% 25%, #e9f0ff 0%, transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow:hidden;
    }

    .hearts{ position:fixed; inset:0; pointer-events:none; opacity:.55; }
    .heart{
      position:absolute;
      width:16px; height:16px;
      transform: rotate(45deg);
      background: color-mix(in srgb, var(--accent) 80%, white);
      border-radius:3px;
      filter: drop-shadow(0 10px 14px rgba(255,79,138,.35));
      animation: floatUp linear infinite;
    }
    .heart::before,.heart::after{
      content:"";
      position:absolute;
      width:16px; height:16px;
      background:inherit;
      border-radius:50%;
    }
    .heart::before{ left:-8px; top:0; }
    .heart::after{ left:0; top:-8px; }
    @keyframes floatUp{
      from{ transform: translateY(30vh) rotate(45deg); opacity:0; }
      10%{ opacity:.55; }
      to{ transform: translateY(-120vh) rotate(45deg); opacity:0; }
    }

    .card{
      width:min(760px, 92vw);
      background:var(--card);
      backdrop-filter: blur(12px);
      border:1px solid #ffffffb3;
      border-radius:30px;
      padding:36px 28px 28px;
      box-shadow: 0 18px 60px rgba(0,0,0,.10);
      text-align:center;
    }

    /* HEAD BIGGER (responsive) */
    .head-img{
      display:block;
      margin: 0 auto 18px;
      width: clamp(220px, 34vw, 340px);
      aspect-ratio: 1 / 1;
      height: auto;
      object-fit: contain;
      filter: drop-shadow(0 14px 22px rgba(0,0,0,.12));
    }

    h1{
      margin:0;
      font-size: clamp(26px, 4.2vw, 42px);
      line-height:1.15;
      letter-spacing:-0.02em;
    }

    /* Absolute layout so YES never shifts */
    .buttons{
      margin-top:26px;
      position:relative;
      height:90px;
    }

    button{
      border:1px solid var(--border);
      background:white;
      color:var(--text);
      padding:14px 26px;
      border-radius:18px;
      font-size:18px;
      cursor:pointer;
      box-shadow: 0 10px 20px rgba(0,0,0,.06);
      transition: transform .12s ease, box-shadow .12s ease;
      user-select:none;
      touch-action: manipulation;
      min-width: 120px;
      position:absolute; /* IMPORTANT: no layout shifting */
      top:50%;
      left:50%;
    }
    button:hover{
      box-shadow: 0 14px 26px rgba(0,0,0,.08);
    }

    /* YES = left, fixed */
    #yesBtn{
      background: linear-gradient(135deg, color-mix(in srgb, var(--accent) 78%, white), #ffd3e3);
      border-color:#ffffff90;
      transform: translate(calc(-50% - 90px), -50%); /* left of center */
      z-index:2;
    }
    /* lock YES from moving on hover */
    #yesBtn:hover{
      transform: translate(calc(-50% - 90px), -50%);
      box-shadow: 0 14px 26px rgba(0,0,0,.08);
    }

    /* NO = right initially, then JS moves it */
    #noBtn{
      transform: translate(calc(-50% + 90px), -50%); /* right of center */
      z-index:1;
    }
  </style>
</head>
<body>
  <div class="hearts" id="hearts"></div>

  <main class="card">
    <img class="head-img" src="./head.png" alt="head">
    <h1 id="title">Karine, will you be my Valentine? üíó</h1>

    <div class="buttons" id="btnArea">
      <button id="yesBtn">Yes</button>
      <button id="noBtn">No</button>
    </div>
  </main>

<script>
  // Optional personalization via URL:
  const params = new URLSearchParams(location.search);
  const name = params.get("name") || "Karine";
  const msg  = params.get("msg")  || "will you be my Valentine? üíó";
  document.getElementById("title").textContent = `${name}, ${msg}`;

  const yesBtn = document.getElementById("yesBtn");
  const noBtn  = document.getElementById("noBtn");
  const area   = document.getElementById("btnArea");

  yesBtn.addEventListener("click", () => {
    window.location.href = "./yes.html" + (location.search || "");
  });

  // ---------- NO —É–±–µ–≥–∞–µ—Ç –û–¢ –∫—É—Ä—Å–æ—Ä–∞ (–≤ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É) + –Ω–µ –∫–ª–∏–∫–∞–µ—Ç—Å—è ----------
  let noReady = false;
  let lastPointer = { x: 0, y: 0 };

  function clamp(v, min, max) { return Math.max(min, Math.min(max, v)); }

  function ensureNoAbsolute(){
    if (noReady) return;

    const a = area.getBoundingClientRect();
    const n = noBtn.getBoundingClientRect();

    // —Ç–µ–∫—É—â–∞—è –≤–∏–∑—É–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è -> –ª–æ–∫–∞–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
    noBtn.style.left = (n.left - a.left) + "px";
    noBtn.style.top  = (n.top  - a.top)  + "px";
    noBtn.style.position = "absolute";
    noBtn.style.transform = "translate(0,0)";

    noReady = true;
  }

  function pointerLocal(e){
    const a = area.getBoundingClientRect();
    return { x: e.clientX - a.left, y: e.clientY - a.top };
  }

  function overlapsYes(left, top, noW, noH){
    const a = area.getBoundingClientRect();
    const y = yesBtn.getBoundingClientRect();

    // YES –≤ –ª–æ–∫–∞–ª—å–Ω—ã–µ + –Ω–µ–±–æ–ª—å—à–æ–π ‚Äú–±—É—Ñ–µ—Ä‚Äù
    const pad = 14;
    const yes = {
      left:   (y.left  - a.left) - pad,
      top:    (y.top   - a.top)  - pad,
      right:  (y.right - a.left) + pad,
      bottom: (y.bottom- a.top)  + pad
    };

    return !(left + noW < yes.left ||
             left > yes.right ||
             top + noH < yes.top ||
             top > yes.bottom);
  }

  function moveNoOpposite(px, py){
    ensureNoAbsolute();

    const a = area.getBoundingClientRect();
    const nRect = noBtn.getBoundingClientRect();
    const noW = nRect.width;
    const noH = nRect.height;

    const pad = 10;
    const maxX = a.width  - noW - pad;
    const maxY = a.height - noH - pad;

    // —Ç–µ–∫—É—â–∏–π —Ü–µ–Ω—Ç—Ä NO (–ª–æ–∫–∞–ª—å–Ω–æ)
    const curLeft = parseFloat(noBtn.style.left || "0");
    const curTop  = parseFloat(noBtn.style.top  || "0");
    const cx = curLeft + noW / 2;
    const cy = curTop  + noH / 2;

    // –≤–µ–∫—Ç–æ—Ä –æ—Ç –∫—É—Ä—Å–æ—Ä–∞ –∫ –∫–Ω–æ–ø–∫–µ (—ç—Ç–æ –∏ –µ—Å—Ç—å ‚Äú–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–±–µ–≥–∞–Ω–∏—è‚Äù)
    let dx = cx - px;
    let dy = cy - py;
    let dist = Math.hypot(dx, dy);

    if (dist < 0.001) { dx = 1; dy = 0; dist = 1; } // –µ—Å–ª–∏ –∫—É—Ä—Å–æ—Ä –ø—Ä—è–º–æ –≤ —Ü–µ–Ω—Ç—Ä–µ

    const MIN_DIST = 140;   // –¥–µ—Ä–∂–∏–º –¥–∏—Å—Ç–∞–Ω—Ü–∏—é –æ—Ç –∫—É—Ä—Å–æ—Ä–∞ –¥–æ —Ü–µ–Ω—Ç—Ä–∞ –∫–Ω–æ–ø–∫–∏
    const LERP = 0.78;      // –ø–ª–∞–≤–Ω–æ—Å—Ç—å/—Å–∫–æ—Ä–æ—Å—Ç—å —É–±–µ–≥–∞–Ω–∏—è (0..1)

    // —Ü–µ–ª—å ‚Äî —Ç–æ—á–∫–∞ –Ω–∞ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏ –≤–æ–∫—Ä—É–≥ –∫—É—Ä—Å–æ—Ä–∞ –≤ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É
    const tx = px + (dx / dist) * MIN_DIST;
    const ty = py + (dy / dist) * MIN_DIST;

    // –ø–ª–∞–≤–Ω–æ –ø—Ä–∏–±–ª–∏–∂–∞–µ–º—Å—è –∫ —Ü–µ–ª–∏ (—á—Ç–æ–±—ã –Ω–µ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∞—Å—å —Ä–µ–∑–∫–æ)
    let nx = cx + (tx - cx) * LERP;
    let ny = cy + (ty - cy) * LERP;

    // —Ü–µ–Ω—Ç—Ä -> left/top
    let left = nx - noW / 2;
    let top  = ny - noH / 2;

    // –µ—Å–ª–∏ –∑–∞–ª–µ–∑–∞–µ–º –Ω–∞ YES ‚Äî —á—É—Ç—å ‚Äú–ø–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ–º‚Äù –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–±–µ–≥–∞–Ω–∏—è
    if (overlapsYes(left, top, noW, noH)) {
      const angles = [Math.PI/3, -Math.PI/3, Math.PI/2, -Math.PI/2, Math.PI*0.75, -Math.PI*0.75];
      for (const ang of angles) {
        const c = Math.cos(ang), s = Math.sin(ang);
        const rdx = dx * c - dy * s;
        const rdy = dx * s + dy * c;
        const rdist = Math.hypot(rdx, rdy) || 1;

        const rtx = px + (rdx / rdist) * MIN_DIST;
        const rty = py + (rdy / rdist) * MIN_DIST;

        nx = cx + (rtx - cx) * LERP;
        ny = cy + (rty - cy) * LERP;

        left = nx - noW / 2;
        top  = ny - noH / 2;

        if (!overlapsYes(left, top, noW, noH)) break;
      }
    }

    // –Ω–µ –≤—ã—Ö–æ–¥–∏–º –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –æ–±–ª–∞—Å—Ç–∏
    left = clamp(left, pad, maxX);
    top  = clamp(top,  pad, maxY);

    noBtn.style.left = left + "px";
    noBtn.style.top  = top  + "px";
  }

  // —É–±–µ–≥–∞–µ—Ç –∑–∞—Ä–∞–Ω–µ–µ, –∫–æ–≥–¥–∞ –∫—É—Ä—Å–æ—Ä –±–ª–∏–∑–∫–æ
  area.addEventListener("pointermove", (e) => {
    const p = pointerLocal(e);
    lastPointer = p;

    ensureNoAbsolute();

    const nRect = noBtn.getBoundingClientRect();
    const noW = nRect.width;
    const noH = nRect.height;

    const left = parseFloat(noBtn.style.left || "0");
    const top  = parseFloat(noBtn.style.top  || "0");
    const cx = left + noW / 2;
    const cy = top  + noH / 2;

    const dist = Math.hypot(cx - p.x, cy - p.y);

    // –ø–æ—Ä–æ–≥ ‚Äú–æ–ø–∞—Å–Ω–æ–π –±–ª–∏–∑–æ—Å—Ç–∏‚Äù
    if (dist < 170) moveNoOpposite(p.x, p.y);
  });

  // –µ—Å–ª–∏ –∫—É—Ä—Å–æ—Ä –≤—Å–µ-—Ç–∞–∫–∏ –∑–∞–¥–µ–ª ‚Äî —Ç–æ–∂–µ —É–±–µ–≥–∞–µ—Ç
  noBtn.addEventListener("pointerenter", () => moveNoOpposite(lastPointer.x, lastPointer.y));

  // –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–ª–æ–∫–∏—Ä—É–µ–º –Ω–∞–∂–∞—Ç–∏—è
  ["pointerdown", "click"].forEach(evt => {
    noBtn.addEventListener(evt, (e) => {
      e.preventDefault();
      e.stopPropagation();
      const p = (e.clientX != null) ? pointerLocal(e) : lastPointer;
      lastPointer = p;
      moveNoOpposite(p.x, p.y);
    });
  });

  // —á—Ç–æ–±—ã –Ω–∞ –º–æ–±–∏–ª–∫–∞—Ö –Ω–µ ‚Äú–Ω–∞–∂–∏–º–∞–ª–æ—Å—å‚Äù
  noBtn.addEventListener("touchstart", (e) => {
    e.preventDefault();
  }, { passive: false });

  // –ø—Ä–∏ —Ä–µ—Å–∞–π–∑–µ –Ω–µ –≤—ã–≤–∞–ª–∏–≤–∞–µ–º—Å—è –∑–∞ –∫—Ä–∞—è
  window.addEventListener("resize", () => {
    if (!noReady) return;
    const a = area.getBoundingClientRect();
    const n = noBtn.getBoundingClientRect();
    const pad = 10;

    const maxX = a.width  - n.width  - pad;
    const maxY = a.height - n.height - pad;

    noBtn.style.left = clamp(parseFloat(noBtn.style.left || "0"), pad, maxX) + "px";
    noBtn.style.top  = clamp(parseFloat(noBtn.style.top  || "0"), pad, maxY) + "px";
  });

  // ---------- Hearts (—Ç–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä) ----------
  const heartsWrap = document.getElementById("hearts");
  const HEARTS = 28;
  for(let i=0;i<HEARTS;i++){
    const h = document.createElement("div");
    h.className = "heart";
    h.style.left = Math.random()*100 + "vw";
    h.style.top  = (60 + Math.random()*60) + "vh";
    h.style.opacity = (0.35 + Math.random()*0.35).toFixed(2);
    const scale = 1.0 + Math.random()*2.2;
    h.style.transform = `rotate(45deg) scale(${scale})`;
    h.style.animationDuration = (6 + Math.random()*8).toFixed(2) + "s";
    h.style.animationDelay = (-Math.random()*10).toFixed(2) + "s";
    heartsWrap.appendChild(h);
  }
</script>
</body>
</html>
